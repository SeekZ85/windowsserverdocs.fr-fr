---
ms.assetid: 6086947f-f9ef-4e18-9f07-6c7c81d7002c
title: Paramètres et outils du service de temps Windows
description: ''
author: shortpatti
ms.author: pashort
manager: dougkim
ms.date: 10/16/2018
ms.topic: article
ms.prod: windows-server
ms.technology: networking
ms.openlocfilehash: 84d10c30d42e92d325475a1143c85acce7456a80
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/27/2019
ms.locfileid: "71395683"
---
# <a name="windows-time-service-tools-and-settings"></a>Paramètres et outils du service de temps Windows
>S'applique à : Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 10 ou version ultérieure

Dans cette rubrique, vous allez découvrir les outils et les paramètres pour le service de temps Windows (W32Time). 

Si vous souhaitez seulement synchroniser l’heure pour un ordinateur client joint à un domaine, consultez [Configurer un ordinateur client pour la synchronisation automatique de l’heure du domaine](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/cc816884%28v%3dws.10%29). Pour obtenir des rubriques supplémentaires sur la configuration du service de temps Windows, consultez [Où trouver des informations sur la configuration du service de temps Windows](https://docs.microsoft.com/windows-server/networking/windows-time-service/windows-time-service-top).  

> [!CAUTION]  
> Vous ne devez pas utiliser la commande Net time pour configurer ou définir l’heure quand le service de temps Windows est en cours d’exécution.  
>
> De plus, sur les ordinateurs plus anciens qui exécutent Windows XP ou une version antérieure, la commande Net time /querysntp affiche le nom d’un serveur NTP (Network Time Protocol) avec lequel un ordinateur est configuré pour se synchroniser, mais ce serveur NTP est utilisé uniquement quand le client de temps de l’ordinateur est configuré en tant que NTP ou AllSync. Cette commande a été dépréciée.  

La plupart des ordinateurs membres du domaine ont un type de client de temps NT5DS, ce qui signifie qu’ils synchronisent l’heure à partir de la hiérarchie de domaine. La seule exception classique est le contrôleur de domaine qui fonctionne en tant que maître d’opérations de l’émulateur du contrôleur de domaine principal du domaine racine de la forêt, qui est généralement configuré pour synchroniser l’heure avec une source de temps externe. Pour voir la configuration du client de temps sur un ordinateur, exécutez la commande W32tm /query /configuration depuis une invite de commandes avec élévation de privilèges à compter de Windows Server 2008 et Windows Vista, puis lisez la ligne **Type** dans la sortie de la commande. Pour plus d’informations, consultez [Fonctionnement du service de temps Windows](https://docs.microsoft.com/windows-server/networking/windows-time-service/How-the-Windows-Time-Service-Works). Vous pouvez exécuter la commande **reg query HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters** et lire la valeur de **NtpServer** dans la sortie de la commande.  

> [!IMPORTANT]  
> Avant Windows Server 2016, le service W32Time n’était pas conçu pour répondre aux besoins des applications sensibles au facteur temps.  Toutefois, les mises à jour vers Windows Server 2016 vous permettent désormais d’implémenter une solution pour une précision de 1 ms dans votre domaine.  Pour plus d’informations, consultez [Précision de l’heure dans Windows Server 2016](accurate-time.md) et [Limites de prise en charge pour configurer le service de temps Windows pour les environnements de haute précision](https://docs.microsoft.com/windows-server/networking/windows-time-service/support-boundary).  

## <a name="windows-time-service-tools"></a>Outils du service de temps Windows  
Les outils suivants sont associés au service de temps Windows.  

#### <a name="w32tmexe-windows-time"></a>W32tm.exe : Horloge Windows  
**Catégorie**  

Cet outil est installé dans le cadre des installations par défaut de Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2.  

**Compatibilité des versions**  

Cet outil fonctionne sur Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2.  

W32tm.exe est utilisé pour configurer les paramètres du service de temps Windows. Il sert également à diagnostiquer les problèmes liés au service de temps. W32tm.exe est l’outil en ligne de commande par défaut pour la configuration, la supervision ou le dépannage du service de temps Windows.  

Les tableaux suivants décrivent les paramètres utilisés avec W32tm.exe.  

**Paramètres principaux de W32tm.exe**  


|                                                                                                                                  Paramètre                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                   W32tm /?                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Aide de la ligne de commande de W32tm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                                                                                                                               W32tm /register                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Inscrit le service de temps pour qu’il s’exécute en tant que service et ajoute la configuration par défaut au Registre.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                                                                                                                              W32tm /unregister                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Annule l’inscription du service de temps et supprime toutes les informations de configuration du Registre.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                                                                 w32tm /monitor<br /><br />[/domain:<domain name>] [/computers:<name>[,<name>[,<name>...]]] [/threads:<num>]                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                 domain : spécifie le domaine à superviser. Si aucun nom de domaine n’est fourni ou que ni l’option domain ni l’option computers ne sont spécifiées, le domaine par défaut est utilisé. Cette option peut être utilisée plusieurs fois.<br /><br />computers : supervise la liste donnée des ordinateurs. Les noms d’ordinateur sont séparés par des virgules, sans espace. Si un nom est préfixé avec « \* », il est traité en tant que contrôleur de domaine principal. Cette option peut être utilisée plusieurs fois.<br /><br />threads : spécifie le nombre d’ordinateurs à analyser simultanément. La valeur par défaut est 3. La plage autorisée est 1 à 50.                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                                                                                                         w32tm /ntte <NT time epoch>                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Convertit une heure système NT, en intervalles de (10^-7)s à partir du 1er janvier 1601 à minuit, dans un format lisible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                                                                                                        w32tm /ntpte <NTP time epoch>                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Convertit une heure NTP, en intervalles de (2^-32)s à partir du 1er janvier 1900 à minuit, dans un format lisible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                                                                               w32tm /resync<br /><br />[/computer:<computer>]<br /><br />[/nowait]<br /><br />[/rediscover]<br /><br />[/soft]                                                                               |                                                                                                                                                                                                                                                                                                                                                                      Indique à un ordinateur qu’il doit resynchroniser son horloge dès que possible, en éliminant toutes les statistiques d’erreurs accumulées.<br /><br />computer :<computer> spécifie l’ordinateur qui doit être resynchronisé. Si ce paramètre n’est pas spécifié, l’ordinateur local est resynchronisé.<br /><br />nowait : ne pas attendre que la resynchronisation se produise ; passer la main immédiatement. Dans le cas contraire, attendre la fin de la resynchronisation avant de passer la main.<br /><br />rediscover : redétecter la configuration réseau et redécouvrir les sources réseau, puis resynchroniser.<br /><br />soft : resynchroniser en utilisant les statistiques d’erreur existantes. Non utile, fourni à des fins de compatibilité.                                                                                                                                                                                                                                                                                                                                                                      |
|                                                          w32tm /stripchart<br /><br />/computer:<target><br /><br />[/period:<refresh>]<br /><br />[/dataonly]<br /><br />[/samples:<count>]<br/><br/>[/rdtsc]<br/>                                                          |                            Afficher un graphique à bandes du décalage entre cet ordinateur et un autre ordinateur.<br /><br />computer :<target> ordinateur sur lequel mesurer le décalage.<br /><br />period :<refresh> délai entre les échantillons, en secondes. La valeur par défaut est 2s.<br /><br />dataonly : afficher uniquement les données sans les graphiques.<br /><br />samples :<count> collecter <count> échantillons, puis arrêter. Si ce paramètre n’est pas spécifié, les échantillons sont collectés jusqu’à ce que l’utilisateur appuie sur **Ctrl + C**.<br/><br/>rdtsc : pour chaque échantillon, cette option affiche les valeurs séparées par des virgules avec les en-têtes RdtscStart, RdtscEnd, FileTime, RoundtripDelay, NtpOffset au lieu du graphique de texte.<br/><ul><li>[RdtscStart](https://en.wikipedia.org/wiki/Time_Stamp_Counter) : valeur RDTSC (Read TimeStamp Counter) collectée juste avant la génération de la demande NTP.</li><li>RdtscEnd : valeur RDTSC (Read TimeStamp Counter) collectée juste après la réception et le traitement de la réponse NTP.</li><li>FileTime : valeur FILETIME locale utilisée dans la demande NTP.</li><li>RoundtripDelay : temps écoulé en secondes entre la génération de la demande NTP et le traitement de la réponse NTP reçue, déterminé en fonction des calculs d’aller-retour NTP.</li><li>NTPOffset : décalage de temps, en secondes, entre l’ordinateur local et le serveur NTP, déterminé en fonction des calculs de décalage NTP.</li></ul>                             |
| w32tm /config<br /><br />[/computer:<target>]<br /><br />[/update]<br /><br />[/manualpeerlist:<peers>]<br /><br />[/syncfromflags:<source>]<br /><br />[/LocalClockDispersion:<seconds>]<br /><br />[/reliable:(YES&#124;NO)]<br /><br />[/largephaseoffset:<milliseconds>] | computer :<target> ajuste la configuration de <target>. Si ce paramètre n’est pas spécifié, la valeur par défaut est l’ordinateur local.<br /><br />update : indique au service de temps que la configuration a changé, entraînant l’application des modifications.<br /><br />manualpeerlist :<peers> définit la liste de pairs manuels sur <peers>, qui est une liste d’adresses DNS et/ou IP délimitée par des espaces. Quand vous spécifiez plusieurs pairs, cette option doit être placée entre guillemets.<br /><br />syncfromflags :<source> définit les sources à partir desquelles le client NTP doit se synchroniser. <source> doit être une liste de mots clés ci-après séparés par des virgules (sans respect de la casse) :<br /><br />MANUAL : inclure les pairs de la liste de pairs manuels.<br /><br />DOMHIER : synchroniser à partir d’un contrôleur de domaine dans la hiérarchie de domaine.<br /><br />LocalClockDispersion :<seconds> configure la précision de l’horloge interne qu’adopte W32Time quand il ne peut pas obtenir le temps de ses sources configurées.<br /><br />reliable:(YES&#124;NO) définir si cet ordinateur est une source de temps fiable.<br /><br />Ce paramètre est uniquement significatif sur les contrôleurs de domaine.<br /><br />YES : cet ordinateur est un service de temps fiable.<br /><br />NO : cet ordinateur n’est pas un service de temps fiable.<br /><br />largephaseoffset :<milliseconds> définit la différence de temps entre l’heure locale et l’heure réseau que W32Time considère comme un pic. |
|                                                                                                                                  w32tm /tz                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Afficher les paramètres du fuseau horaire actuel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                                                                  w32tm /dumpreg<br /><br />[/subkey:<key>]<br /><br />[/computer:<target>]                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Afficher les valeurs associées à une clé de Registre donnée.<br /><br />La clé par défaut est HKLM\System\CurrentControlSet\Services\W32Time<br /><br />(clé racine du service de temps).<br /><br />subkey :<key> affiche les valeurs associées à la sous-clé <key> de la clé par défaut.<br /><br />computer :<target> interroge les paramètres de Registre pour l’ordinateur <target>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                                                                                  w32tm /query [/computer:<target>] {/source &#124; /configuration &#124; /peers &#124; /status} [/verbose]                                                                                   |                                                                                                                                                                                                                                                                                                                  Ce paramètre a été mis à disposition pour la première fois dans les versions clientes du service de temps Windows de Windows Vista et Windows Server 2008.<br /><br />Afficher les informations du service de temps Windows d’un ordinateur.<br /><br />**computer :<target>** interroger les informations de **<target>** . Si ce paramètre n’est pas spécifié, la valeur par défaut est l’ordinateur local.<br /><br />**Source** : afficher la source de temps.<br /><br />**Configuration** : afficher la configuration de l’exécution et l’origine du paramètre. En mode détaillé, afficher également le paramètre non défini ou inutilisé.<br /><br />**peers** : afficher une liste de pairs et leur état.<br /><br />**status** : afficher l’état du service de temps Windows.<br /><br />**verbose** : activer le mode détaillé pour afficher plus d’informations.                                                                                                                                                                                                                                                                                                                   |
|                                                                                       w32tm /debug {/disable &#124; {/enable /file:<name> /size:<bytes> /entries:<value> [/truncate]}}                                                                                       |                                                                                                                                                                                                                                                                         Ce paramètre a été mis à disposition pour la première fois dans les versions clientes du service de temps Windows de Windows Vista et Windows Server 2008.<br /><br />Activer ou désactiver le journal privé du service de temps Windows de l’ordinateur local.<br /><br />**disable** : désactiver le journal privé.<br /><br />**enable** : activer le journal privé.<br /><br />-   **file :<name>** spécifier le nom de fichier absolu.<br />-   **size :<bytes>** spécifier la taille maximale de la journalisation circulaire.<br />-   **entries :<value>** contient une liste d’indicateurs, spécifiés par un nombre et séparés par des virgules, qui spécifient les types d’informations à journaliser. Les nombres valides sont compris entre 0 et 300. Une plage de nombres est valide au même titre que les nombres uniques ; vous pouvez, par exemple, indiquer 0-100,103,106. La valeur 0-300 correspond à la journalisation de toutes les informations.<br /><br />**truncate** : tronquer le fichier s’il existe.                                                                                                                                                                                                                                                                          |

---  
Pour plus d’informations sur **W32tm.exe**, consultez le Centre d’aide et de support dans Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2.  

## <a name="windows-time-service-registry-entries"></a>Entrées de Registre du service de temps Windows
Les entrées de Registre suivantes sont associées au service de temps Windows.  

Ces informations sont fournies à titre de référence et peuvent être utilisées dans le cadre de la résolution de problèmes ou de la vérification de l’application des paramètres requis. Nous vous recommandons de ne pas modifier directement le Registre, sauf s’il n’y a pas d’autre solution. Les modifications apportées au Registre ne sont pas validées par l’Éditeur du Registre ni par Windows avant d’être appliquées ; des valeurs incorrectes peuvent donc être stockées. Cela peut entraîner des erreurs irrécupérables dans le système.  

Si possible, utilisez la stratégie de groupe ou d’autres outils Windows tels que la console MMC (Microsoft Management) pour exécuter des opérations, au lieu de modifier le Registre directement. Si vous devez modifier le Registre, soyez très vigilant.  

> [!WARNING]  
> Certaines des valeurs prédéfinies qui sont configurées dans le fichier de modèle d’administration système (System.adm) pour les paramètres de l’objet de stratégie de groupe (GPO) sont différentes des entrées de Registre par défaut correspondantes. Si vous envisagez d’utiliser un GPO pour configurer un paramètre du service de temps Windows, veillez à consulter [Les valeurs prédéfinies pour les paramètres de stratégie de groupe du service de temps Windows sont différentes des entrées de Registre du service de temps Windows correspondantes dans Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Ce problème concerne Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 et Windows Server 2003.  

De nombreuses entrées de Registre pour le service de temps Windows sont les mêmes que le paramètre de stratégie de groupe du même nom. Les paramètres de stratégie de groupe correspondent aux entrées de Registre du même nom situées dans :  

>**HKLM\SYSTEM\CurrentControlSet\Services\W32Time\\**


Il existe plusieurs clés de Registre à cet emplacement du Registre. Les paramètres du service de temps Windows sont stockés dans des valeurs au sein de toutes les clés suivantes :

* [Parameters](#hklmsystemcurrentcontrolsetservicesw32timeparameters)
* [Config](#hklmsystemcurrentcontrolsetservicesw32timeconfig)
* [NtpClient](#hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpclient)
* [NtpServer](#hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpserver)

La plupart des valeurs de la section W32Time du Registre sont utilisées en interne par W32Time pour stocker des informations. Ces valeurs ne doivent jamais être modifiées manuellement. Ne modifiez aucun paramètre de cette section, sauf si vous êtes familiarisé avec le paramètre concerné et que vous êtes certain que la nouvelle valeur fonctionnera comme prévu. Les entrées de Registre suivantes se trouvent sous :

**HKLM\SYSTEM\CurrentControlSet\Services\W32Time**  

Quand vous créez une stratégie, les paramètres sont configurés à l’emplacement suivant, qui n’est pas prioritaire par rapport au prochain emplacement :

**HKLM\SOFTWARE\Policies\Microsoft\Windows\W32time**

La clé W32time est créée avec la stratégie.  La suppression de la stratégie entraîne celle de cette clé.

L’autre emplacement par défaut :

**HKLM\SYSTEM\CurrentControlSet\Services\W32time**

Certains des paramètres sont stockés en cycles d’horloge dans le Registre, d’autres en secondes. Pour convertir l’heure, exprimée en cycles d’horloge, en secondes :  

-   1 minute = 60 s  

-   1 s = 1000 ms  

-   1 ms = 10 000 cycles d’horloge sur un système Windows, comme décrit dans [Propriété DateTime.Ticks](https://docs.microsoft.com/dotnet/api/system.datetime.ticks?redirectedfrom=MSDN&view=netframework-4.7.2#System_DateTime_Ticks).  

Par exemple, 5 minutes deviennent 5\*60\*1000\*10000 = 3 milliards cycles d’horloge. 

Toutes les versions incluent Windows 7, Windows 8, Windows 10, Windows Server 2008 et Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, Windows Server 2016.  Certaines entrées sont uniquement disponibles sur les versions plus récentes de Windows.

#### <a name="hklmsystemcurrentcontrolsetservicesw32timeparameters"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters

|          Entrée de Registre          | Version |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AllowNonstandardModeCombinations |   Tous   |                                                                                                                                                                                                                                                                                                                                                                                                              Indique que les combinaisons de mode non standard sont autorisées dans la synchronisation entre pairs. La valeur par défaut pour les membres du domaine est 1. La valeur par défaut pour les serveurs et les clients autonomes est 1.                                                                                                                                                                                                                                                                                                                                                                                                              |
|            NtpServer             |   Tous   | Spécifie une liste délimitée par des espaces comportant les pairs à partir desquels un ordinateur obtient des horodatages, constitués d’un ou plusieurs noms DNS ou adresses IP par ligne. Chaque nom DNS ou adresse IP listé doit être unique. Les ordinateurs connectés à un domaine doivent se synchroniser avec une source de temps plus fiable, telle que l’horloge des États-Unis officielle.  <ul><li>0x01 SpecialInterval </li><li>0x02 UseAsFallbackOnly</li><li>0x04 SymmetricActive : pour plus d’informations sur ce mode, consultez [Windows Time Server: 3.3 Modes of Operation](https://go.microsoft.com/fwlink/?LinkId=208012).</li><li>0x08 Client</li></ul><br />Il n’existe pas de valeur par défaut pour cette entrée de Registre sur les membres du domaine. La valeur par défaut sur les serveurs et les clients autonomes est time.windows.com,0x1.<br /><br />Remarque : Pour plus d’informations sur les serveurs NTP disponibles, consultez l’[article 262680 de la base de connaissances Microsoft : Liste des serveurs de temps SNTP (Simple Network Time Protocol) disponibles sur Internet](https://support.microsoft.com/help/262680/a-list-of-the-simple-network-time-protocol-sntp-time-servers-that-are). |
|            ServiceDll            |   Tous   |                                                                                                                                                                                                                                                                                                                                                              Est gérée par W32Time. Elle contient des données réservées utilisées par le système d’exploitation Windows ; toute modification apportée à ce paramètre peut entraîner des résultats imprévisibles. L’emplacement par défaut de cette DLL à la fois sur les membres du domaine et sur les serveurs et les clients autonomes est %windir%\System32\W32Time.dll.                                                                                                                                                                                                                                                                                                                                                               |
|           ServiceMain            |   Tous   |                                                                                                                                                                                                                                                                                                                                                       Est gérée par W32Time. Elle contient des données réservées utilisées par le système d’exploitation Windows ; toute modification apportée à ce paramètre peut entraîner des résultats imprévisibles. La valeur par défaut sur les membres du domaine est SvchostEntry_W32Time. La valeur par défaut sur les serveurs et les clients autonomes est SvchostEntry_W32Time.  "                                                                                                                                                                                                                                                                                                                                                       |
|               Type               |   Tous   |                                                                                                                                                                                                                                  Indique les pairs à partir desquels accepter la synchronisation :  <ul><li>**NoSync**. Le service de temps ne se synchronise pas avec d’autres sources.</li><li>**NTP.** Le service de temps se synchronise à partir des serveurs spécifiés dans l’entrée de Registre **NtpServer** .</li><li>**NT5DS**. Le service de temps se synchronise à partir de la hiérarchie du domaine.  </li><li>**AllSync**. Le service de temps utilise tous les mécanismes de synchronisation disponibles.  </li></ul>La valeur par défaut sur les membres du domaine est **NT5DS**. La valeur par défaut sur les serveurs et les clients autonomes est **NTP**.                                                                                                                                                                                                                                   |

---
#### <a name="hklmsystemcurrentcontrolsetservicesw32timeconfig"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Config

|    Entrée de Registre     |          Version           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     AnnounceFlags     |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Détermine si cet ordinateur est marqué comme serveur de temps fiable. Un ordinateur n’est pas marqué comme fiable, sauf s’il est également marqué comme serveur de temps.<br /> - 0x00 Pas un serveur de temps  <br /> - 0x01 Toujours un serveur de temps  <br /> - 0x02 Serveur de temps automatique  <br /> - 0x04 Toujours un serveur de temps fiable  <br /> - 0x08 Serveur de temps fiable automatique  <br />La valeur par défaut pour les membres du domaine est 10. La valeur par défaut pour les serveurs et les clients autonomes est 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|     EventLogFlags     |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Contrôle les événements journalisés par le service de temps.  <br />- Décalage de temps : 0x1  <br />- Changement de la source : 0x2  <br />La valeur par défaut sur les membres du domaine est 2. La valeur par défaut sur les serveurs et les clients autonomes est 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| FrequencyCorrectRate  |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Contrôle la fréquence de correction de l’horloge. Si cette valeur est trop petite, l’horloge est instable et fait l’objet d’une correction excessive. Si la valeur est trop grande, la synchronisation de l’horloge prend beaucoup de temps. La valeur par défaut sur les membres du domaine est 4. La valeur par défaut sur les serveurs et les clients autonomes est 4.  <br /><br />Notez que 0 est une valeur non valide pour l’entrée de Registre FrequencyCorrectRate. Sur les ordinateurs Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2, si la valeur est définie sur 0, le service de temps Windows la remplace automatiquement par 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|      HoldPeriod       |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Contrôle la durée pendant laquelle la détection des pics est désactivée afin de mettre rapidement l’horloge locale en mode synchronisation. Un pic est un échantillon de temps qui indique que le temps est désactivé pendant un certain nombre de secondes, et est généralement reçu après que des échantillons de temps corrects ont été retournés de façon cohérente. La valeur par défaut sur les membres du domaine est 5. La valeur par défaut sur les serveurs et les clients autonomes est 5.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|   LargePhaseOffset    |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Spécifie qu’un décalage de temps supérieur ou égal à cette valeur en 10<sup>-7</sup> secondes est considéré comme un pic. Une interruption du réseau, telle qu’une grande quantité de trafic, peut entraîner un pic. Un pic est ignoré à moins qu’il persiste pendant une longue période de temps. La valeur par défaut sur les membres du domaine est 50000000. La valeur par défaut sur les serveurs et les clients autonomes est 50000000.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     LastClockRate     |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Est gérée par W32Time. Elle contient des données réservées utilisées par le système d’exploitation Windows ; toute modification apportée à ce paramètre peut entraîner des résultats imprévisibles. La valeur par défaut sur les membres du domaine est 156250. La valeur par défaut sur les serveurs et les clients autonomes est 156250.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LocalClockDispersion  |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Contrôle la dispersion (en secondes) que vous devez supposer quand la seule source de temps est l’horloge CMOS intégrée. La valeur par défaut sur les membres du domaine est 10. La valeur par défaut sur les serveurs et les clients autonomes est 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| MaxAllowedPhaseOffset |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Spécifie le décalage maximal (en secondes) pendant lequel W32Time tente d’ajuster l’horloge de l’ordinateur à l’aide de la fréquence d’horloge. Quand le décalage dépasse cette fréquence, W32Time définit l’horloge de l’ordinateur directement. La valeur par défaut pour les membres du domaine est 300. La valeur par défaut pour les serveurs et les clients autonomes est 1.  [Pour plus d’informations, voir ci-dessous.](#maxallowedphaseoffset-information)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     MaxClockRate      |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Est gérée par W32Time. Elle contient des données réservées utilisées par le système d’exploitation Windows ; toute modification apportée à ce paramètre peut entraîner des résultats imprévisibles. La valeur par défaut pour les membres du domaine est 155860. La valeur par défaut pour les serveurs et les clients autonomes est 155860.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| MaxNegPhaseCorrection |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Spécifie la plus grande correction de temps négative en secondes effectuée par le service. Si le service détermine qu’une modification supérieure à celle-ci est nécessaire, il journalise un événement à la place. Cas particulier : 0xFFFFFFFF signifie toujours effectuer une correction de temps. La valeur par défaut pour les membres du domaine est 0xFFFFFFFF. La valeur par défaut pour les serveurs et les clients autonomes est 54 000 (15 heures).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|    MaxPollInterval    |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Spécifie le plus grand intervalle, en secondes log2, autorisé pour l’intervalle d’interrogation du système. Notez que, si un système doit effectuer une interrogation en fonction de l’intervalle planifié, un fournisseur peut refuser de produire des échantillons quand il y est invité. La valeur par défaut pour les contrôleurs de domaine est 10. La valeur par défaut pour les membres du domaine est 15. La valeur par défaut pour les serveurs et les clients autonomes est 15.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| MaxPosPhaseCorrection |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Spécifie la plus grande correction de temps positive en secondes effectuée par le service. Si le service détermine qu’une modification supérieure à celle-ci est nécessaire, il journalise un événement à la place. Cas particulier : 0xFFFFFFFF signifie toujours effectuer une correction de temps. La valeur par défaut pour les membres du domaine est 0xFFFFFFFF. La valeur par défaut pour les serveurs et les clients autonomes est 54 000 (15 heures).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|     MinClockRate      |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Est gérée par W32Time. Elle contient des données réservées utilisées par le système d’exploitation Windows ; toute modification apportée à ce paramètre peut entraîner des résultats imprévisibles. La valeur par défaut pour les membres du domaine est 155860. La valeur par défaut pour les serveurs et les clients autonomes est 155860.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|    MinPollInterval    |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Spécifie le plus petit intervalle, en secondes log2, autorisé pour l’intervalle d’interrogation du système. Notez que bien qu’un système ne demande pas d’échantillons plus souvent, un fournisseur peut produire des échantillons à d’autres moments que l’intervalle planifié. La valeur par défaut pour les contrôleurs de domaine est 6. La valeur par défaut pour les membres du domaine est 10. La valeur par défaut pour les serveurs et les clients autonomes est 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|   PhaseCorrectRate    |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Contrôle la fréquence de correction de l’erreur de phase. La spécification d’une petite valeur corrige rapidement l’erreur de phase, mais peut entraîner l’instabilité de l’horloge. Si la valeur est trop grande, il faut plus de temps pour corriger l’erreur de phase. <br /><br />La valeur par défaut sur les membres du domaine est 1. La valeur par défaut sur les serveurs et les clients autonomes est 7.<br /><br />Remarque : 0 est une valeur non valide pour l’entrée de Registre PhaseCorrectRate. Sur les ordinateurs Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2, si la valeur est définie sur 0, le service de temps Windows la remplace automatiquement par 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|   PollAdjustFactor    |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Contrôle la décision d’augmenter ou de diminuer l’intervalle d’interrogation pour le système. Plus la valeur est élevée, plus la quantité d’erreur qui entraîne la diminution de l’intervalle d’interrogation est faible. La valeur par défaut sur les membres du domaine est 5. La valeur par défaut sur les serveurs et les clients autonomes est 5.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|   SpikeWatchPeriod    |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Spécifie la durée pendant laquelle un décalage suspect doit être conservé avant qu’il soit accepté comme correct (en secondes). La valeur par défaut sur les membres du domaine est 900. La valeur par défaut sur les stations de travail et les clients autonomes est 900.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|  TimeJumpAuditOffset  |            Tous             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Entier non signé qui indique le seuil d’audit de décalage de temps, en secondes. Si le service de temps ajuste l’horloge locale en définissant l’horloge directement et que la correction de l’heure est supérieure à cette valeur, le service de temps journalise un événement d’audit.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|    UpdateInterval     |            Tous             | Spécifie le nombre de cycles d’horloge entre les ajustements de correction de phase. La valeur par défaut pour les contrôleurs de domaine est 100. La valeur par défaut pour les membres du domaine est 30 000. La valeur par défaut pour les serveurs et les clients autonomes est 360 000.  <br /><br />**REMARQUE** : Zéro est une valeur non valide pour l’entrée de Registre UpdateInterval. Sur les ordinateurs exécutant Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2, si la valeur est définie sur 0, le service de temps Windows la remplace automatiquement par 1.<br /><br />Les trois entrées de Registre suivantes ne font pas partie de la configuration par défaut de W32Time, mais peuvent être ajoutées au Registre pour obtenir des fonctionnalités de journalisation accrues. Vous pouvez modifier les informations journalisées dans le journal des événements système en changeant la valeur du paramètre EventLogFlags dans l’Éditeur d’objets de stratégie de groupe. Par défaut, le service de temps crée un journal dans l’observateur d’événements chaque fois qu’il bascule vers une nouvelle source de temps.<br /><br />**AVERTISSEMENT** : Certaines des valeurs prédéfinies qui sont configurées dans le fichier de modèle d’administration système (System.adm) pour les paramètres de l’objet de stratégie de groupe (GPO) sont différentes des entrées de Registre par défaut correspondantes. Si vous envisagez d’utiliser un GPO pour configurer un paramètre du service de temps Windows, veillez à consulter [Les valeurs prédéfinies pour les paramètres de stratégie de groupe du service de temps Windows sont différentes des entrées de Registre du service de temps Windows correspondantes dans Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Ce problème concerne Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 et Windows Server 2003. |
|  UtilizeSslTimeData   | Postérieures à Windows 10, build 1511 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             L’entrée 1 indique que W32Time utilise plusieurs horodatages SSL pour amorcer une horloge qui est grossièrement inexacte.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

---
Vous devez ajouter les entrées de Registre suivantes pour activer la journalisation de W32Time :  

|Entrée de Registre|Version|Description|
|------------------------------------|---------------|----------------------------|
|FileLogEntries|Tous|Contrôle la quantité d’entrées créées dans le fichier journal du service de temps Windows. La valeur par défaut est none : aucune activité du service de temps Windows n’est journalisée. La valeur indiquée doit être comprise entre 0 et 300. Cette valeur n’affecte pas les entrées de journal des événements normalement créées par le service de temps Windows.|
|FileLogName|Tous|Contrôle l’emplacement et le nom de fichier du journal du service de temps Windows. La valeur par défaut est vide et ne doit pas être modifiée, sauf si **FileLogEntries** est changé. Une valeur valide est un chemin complet et un nom de fichier que le service de temps Windows utilise pour créer le fichier journal. Cette valeur n’affecte pas les entrées de journal des événements normalement créées par le service de temps Windows.  |
|FileLogSize|Tous|Contrôle le comportement de journalisation circulaire des fichiers journaux du service de temps Windows. Quand **FileLogEntries** et **FileLogName** sont définis, l’entrée définit la taille, en octets, que peut atteindre le fichier journal avant que les entrées de journal les plus anciennes ne soient remplacées par de nouvelles entrées. Utilisez 1000000 ou une valeur supérieure pour ce paramètre. Cette valeur n’affecte pas les entrées de journal des événements normalement créées par le service de temps Windows.  |

---

#### <a name="hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpclient"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient

|Entrée de Registre|Version|Description|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Tous|Indique que les combinaisons de mode non standard sont autorisées dans la synchronisation entre pairs. La valeur par défaut pour les membres du domaine est 1. La valeur par défaut pour les serveurs et les clients autonomes est 1.|
|CompatibilityFlags|Tous|Spécifie les valeurs et indicateurs de compatibilité suivants : <br /><br />- DispersionInvalid : 0x00000001  <br />- IgnoreFutureRefTimeStamp : 0x00000002  <br /> - AutodetectWin2K : 0x80000000  <br />- AutodetectWin2KStage2 : 0x40000000  <br /><br />La valeur par défaut pour les membres du domaine est 0x80000000. La valeur par défaut pour les serveurs et les clients autonomes est 0x80000000.  |
|CrossSiteSyncFlags|Tous|Détermine si le service choisit des partenaires de synchronisation en dehors du domaine de l’ordinateur. Les options et les valeurs sont les suivantes :  <br /><br />- None : 0  <br />- PdcOnly : 1  <br />- All : 2  <br /><br />Cette valeur est ignorée si la valeur NT5DS n’est pas définie. La valeur par défaut pour les membres du domaine est 2. La valeur par défaut pour les serveurs et les clients autonomes est 2.  |
|DllName|Tous|Spécifie l’emplacement de la DLL pour le fournisseur de temps.  <br /><br />L’emplacement par défaut de cette DLL à la fois sur les membres du domaine et sur les serveurs et les clients autonomes est %windir%\System32\W32Time.dll.|
|Activé|Tous|Indique si le fournisseur NtpClient est activé dans le service de temps actuel.  <br /><ul><li>Oui 1</li><li>Non 0</li></ul>La valeur par défaut sur les membres du domaine est 1. La valeur par défaut sur les serveurs et les clients autonomes est 1.|
|EventLogFlags|Tous|Spécifie les événements journalisés par le service de temps Windows.<ul><li>0x1 Modifications de l’accessibilité</li><li>0X2 Grand biais d’échantillon (concerne uniquement Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2)</li></ul>La valeur par défaut sur les membres du domaine est 0x1. La valeur par défaut sur les serveurs et les clients autonomes est 0x1.|
|InputProvider|Tous|Indique s’il faut activer NtpClient en tant qu’InputProvider, qui obtient des informations de temps à partir de NtpServer. NtpServer est un serveur de temps qui répond aux demandes de temps du client sur le réseau en retournant des échantillons de temps utiles pour la synchronisation de l’horloge locale. <ul><li>Oui = 1  </li><li>Non = 0 </li></ul><p>Valeur par défaut pour les membres du domaine et les clients autonomes : 1  |
|LargeSampleSkew|Tous|Spécifie le grand biais d’échantillon pour la journalisation en secondes. Pour se conformer aux spécifications SEC (Security and Exchange Commission), cette valeur doit être définie sur trois secondes. Les événements sont journalisés pour ce paramètre uniquement quand EventLogFlags est configuré de manière explicite pour un grand biais d’échantillon 0X2. La valeur par défaut sur les membres du domaine est 3. La valeur par défaut sur les serveurs et les clients autonomes est 3.  |
|ResolvePeerBackOffMaxTimes|Tous|Spécifie le nombre maximal de fois que l’intervalle d’attente doit être doublé quand des tentatives répétées de localisation d’un pair avec lequel effectuer une synchronisation échouent. La valeur zéro signifie que l’intervalle d’attente est toujours le minimum. La valeur par défaut sur les membres du domaine est 7. La valeur par défaut sur les serveurs et les clients autonomes est 7. |
|ResolvePeerBackoffMinutes|Tous|Spécifie l’intervalle initial, en minutes, pendant lequel attendre avant de rechercher un pair avec lequel effectuer une synchronisation. La valeur par défaut sur les membres du domaine est 15. La valeur par défaut sur les serveurs et les clients autonomes est 15.  |
|SpecialPollInterval|Tous|Spécifie l’intervalle d’interrogation spécial, en secondes, pour les pairs manuels. Quand l’indicateur SpecialInterval 0x1 est activé, W32Time utilise cet intervalle d’interrogation au lieu d’un intervalle d’interrogation déterminé par le système d’exploitation. La valeur par défaut sur les membres du domaine est 3 600. La valeur par défaut sur les serveurs et les clients autonomes est 604 800.<br/><br/>Nouveauté de la build 1702 : SpecialPollInterval fait partie des valeurs de registre de configuration MinPollInterval et MaxPollInterval.|
|SpecialPollTimeRemaining|Tous|Est gérée par W32Time. Elle contient des données réservées qui sont utilisées par le système d’exploitation Windows. Elle spécifie la durée (en secondes) avant que W32Time ne se resynchronise après le redémarrage de l’ordinateur. Toute modification apportée à ce paramètre peut engendrer des résultats imprévisibles. La valeur par défaut, tant sur les membres du domaine que sur les serveurs et clients autonomes, est laissée vide.  |

---

#### <a name="hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpserver"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpServer

|Entrée de Registre|Version|Description|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Tous|Indique que les combinaisons de mode non standard sont autorisées dans la synchronisation entre les clients et les serveurs. La valeur par défaut pour les membres du domaine est 1. La valeur par défaut pour les serveurs et les clients autonomes est 1.|
|DllName|Tous|Spécifie l’emplacement de la DLL pour le fournisseur de temps.<br /><br />L’emplacement par défaut de cette DLL à la fois sur les membres du domaine et sur les serveurs et les clients autonomes est %windir%\System32\W32Time.dll.  |
|Activé|Tous|Indique si le fournisseur NtpServer est activé dans le service de temps actuel. <ul><li>Oui 1</li><li>Non 0</li></ul>La valeur par défaut sur les membres du domaine est 1. La valeur par défaut sur les serveurs et les clients autonomes est 1.  |
|InputProvider|Tous|Indique s’il faut activer NtpClient en tant qu’InputProvider, qui obtient des informations de temps à partir de NtpServer. NtpServer est un serveur de temps qui répond aux demandes de temps du client sur le réseau en retournant des échantillons de temps utiles pour la synchronisation de l’horloge locale. <ul><li>Oui = 1  </li><li>Non = 0 </li></ul><p>Valeur par défaut pour les membres du domaine et les clients autonomes : 1  |

---

#### <a name="maxallowedphaseoffset-information"></a>Informations MaxAllowedPhaseOffset
Pour que W32Time définisse progressivement l’horloge de l’ordinateur, le décalage doit être inférieur à la valeur **MaxAllowedPhaseOffset** et répondre à l’équation suivante en même temps :  

* Windows Server 2016 et versions ultérieures :
   ```  
    |CurrentTimeOffset| / (16*PhaseCorrectRate*pollIntervalInSeconds) <= SystemClockRate / 2  
   ``` 
* Windows Server 2012 R2 et versions antérieures :
   ```  
   |CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2  
   ``` 
La valeur **CurrentTimeOffset** est mesurée en cycles d’horloge, où 1 ms représente 10 000 cycles d’horloge sur un système Windows.  

**SystemClockRate** et **PhaseCorrectRate** sont également mesurés en cycles d’horloge. Pour récupérer la valeur **SystemClockRate**, vous pouvez utiliser la commande suivante et convertir le résultat en cycles d’horloge en utilisant la formule : secondes*1000\*10000 :  

```  
W32tm /query /status /verbose  
ClockRate: 0.0156000s  
```  

**SystemclockRate** est la fréquence de l’horloge sur le système. En utilisant 156 000 secondes comme exemple, la valeur **SystemclockRate** est : 0,0156000 \* 1000 \* 10000, soit 156 000 cycles d’horloge.  

La valeur **MaxAllowedPhaseOffset** est également exprimée en secondes. Pour la convertir en cycles d’horloge, effectuez la multiplication **MaxAllowedPhaseOffset**\*1000\*10000.  

Les exemples suivants montrent comment appliquer ces calculs quand vous utilisez Windows Server 2012 R2 ou une version antérieure.

**Exemple 1** : L’heure diffère de 4 minutes (par exemple, votre heure est 11:05, tandis que l’échantillon de temps que vous avez reçu d’un pair et que vous estimez être correct est 11:09).
  
```
phasecorrectRate = 1  

UpdateInterval = 30000 (clock ticks)  

systemclockRate = 156000 (clock ticks)  

MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  

|currentTimeOffset| = 4mins = 4*60\*1000\*10000 = 2400000000 ticks  

Is CurrentTimeOffset <= MaxAllowedPhaseOffset?  

2400000000 <= 6000000000 = TRUE  
```

ET l’équation ci-dessus est-elle satisfaite ? 

```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2)  

Is 2,400,000,000 / (30000*1) <= 156000/2  

Is 80,000 <= 78,000  

NO/FALSE  
```  

Ainsi, W32tm redéfinit l’horloge immédiatement.  

> [!NOTE]  
> Dans ce cas, si vous souhaitez redéfinir l’horloge lentement, vous devez également ajuster les valeurs de **PhaseCorrectRate** ou **updateInterval** dans le Registre afin que le résultat de l’équation soit **TRUE**.  

**Exemple 2** : L’heure diffère de 3 minutes. 
 
```  
phasecorrectRate = 1  

UpdateInterval = 30000 (clock ticks)  

systemclockRate = 156000 (clock ticks)  

MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  

currentTimeOffset = 3mins = 3*60\*1000\*10000 = 1800000000 clock ticks  

Is CurrentTimeOffset <= MaxAllowedPhaseOffset?  

1800000000 <= 6000000000 = TRUE  
```  

ET l’équation ci-dessus est-elle satisfaite ?

```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2)  

Is 3 mins (1,800,000,000) / (30000*1) <= 156000/2  

Is 60,000 <= 78,000  

YES/TRUE  
```  

Dans ce cas, l’horloge est redéfinie lentement.  

## <a name="windows-time-service-group-policy-settings"></a>Paramètres de stratégie de groupe du service de temps Windows  
Vous pouvez configurer la plupart des paramètres W32Time à l’aide de l’Éditeur d’objets de stratégie de groupe. Cela comprend la configuration d’un ordinateur en tant que NTPServer ou NTPClient, la configuration du mécanisme de synchronisation de l’heure et la configuration d’un ordinateur en tant que source de temps fiable.  

> [!NOTE]  
> Les paramètres de stratégie de groupe du service de temps Windows peuvent être configurés sur des contrôleurs de domaine Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2 et peuvent être appliqués uniquement aux ordinateurs exécutant Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 et Windows Server 2008 R2.  

Vous trouverez les paramètres de stratégie de groupe utilisés pour configurer W32Time dans le composant logiciel enfichable Éditeur d’objets de stratégie de groupe aux emplacements suivants :  

-   Computer Configuration\Administrative Templates\System\Windows Time Service  

    Configurez les **Paramètres de configuration générale** à cet endroit.  

-   Computer Configuration\Administrative Templates\System\Windows Time Service\Time Providers  

    Configurez les paramètres du **Client NTP Windows** à cet endroit.  

    Activez le **Client NTP Windows** à cet endroit.  

    Activez le **Serveur NTP Windows** à cet endroit.  

> [!WARNING]  
> Certaines des valeurs prédéfinies qui sont configurées dans le fichier de modèle d’administration système (System.adm) pour les paramètres de l’objet de stratégie de groupe (GPO) sont différentes des entrées de Registre par défaut correspondantes. Si vous envisagez d’utiliser un GPO pour configurer un paramètre du service de temps Windows, veillez à consulter [Les valeurs prédéfinies pour les paramètres de stratégie de groupe du service de temps Windows sont différentes des entrées de Registre du service de temps Windows correspondantes dans Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Ce problème concerne Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 et Windows Server 2003.  

Le tableau suivant liste les paramètres de stratégie de groupe globaux associés au service de temps Windows et la valeur prédéfinie associée à chaque paramètre. Pour plus d’informations sur chaque paramètre, consultez les entrées de Registre correspondantes dans [Entrées de Registre du service de temps Windows](#windows-time-service-registry-entries) plus haut dans ce sujet. Les paramètres suivants sont contenus dans un seul objet GPO appelé **Paramètres de configuration générale**.  

**Paramètres de stratégie de groupe globaux associés au service de temps Windows**  

|Paramètre de stratégie de groupe|Valeur prédéfinie|  
|------------------------|------------------|  
|AnnounceFlags|10|  
|EventLogFlags|2|  
|FrequencyCorrectRate|4|  
|HoldPeriod|5|  
|LargePhaseOffset|1280000|  
|LocalClockDispersion|10|  
|MaxAllowedPhaseOffset|300|  
|MaxNegPhaseCorrection|54 000 (15 heures)|  
|MaxPollInterval|15|  
|MaxPosPhaseCorrection|54 000 (15 heures)|  
|MinPollInterval|10|  
|PhaseCorrectRate|7|  
|PollAdjustFactor|5|  
|SpikeWatchPeriod|90|  
|UpdateInterval|100|  

Le tableau suivant liste les paramètres disponibles pour l’objet de stratégie de groupe **Configurer le client NTP Windows** et les valeurs prédéfinies associées au service de temps Windows. Pour plus d’informations sur chaque paramètre, consultez les entrées de Registre correspondantes dans [Entrées de Registre du service de temps Windows](#windows-time-service-registry-entries) plus haut dans ce sujet.  

**Paramètres de stratégie de groupe du client NTP associés au service de temps Windows**  

|Paramètre de stratégie de groupe|Valeur par défaut|  
|------------------------|-----------------|  
|NtpServer|time.windows.com,0x1|  
|Type|Options par défaut :<br /><br />-   **NTP.** Utilisez cette option sur des ordinateurs non joints à un domaine.<br />-   **NT5DS.** Utilisez cette option sur des ordinateurs joints à un domaine.|  
|CrossSiteSyncFlags|2|  
|ResolvePeerBackoffMinutes|15|  
|ResolvePeerBackoffMaxTimes|7|  
|SpecialPollInterval|3600|  
|EventLogFlags|0|  

## <a name="network-ports-used-by-the-windows-time-service"></a>Ports réseau utilisés par le service de temps Windows  
Le service de temps Windows suit la spécification NTP, qui exige l’utilisation du port UDP 123 pour toute communication de la synchronisation de l’heure. Ce port est réservé par le service de temps Windows et le reste en permanence. Chaque fois que l’ordinateur synchronise son horloge ou fournit l’heure à un autre ordinateur, cette communication est effectuée sur le port UDP 123.  

> [!NOTE]  
> Si vous disposez d’un ordinateur équipé de plusieurs cartes réseau (également appelé « ordinateur multirésident »), vous ne pouvez pas activer de manière sélective le service de temps Windows en fonction de la carte réseau.  

## <a name="related-information"></a>Informations connexes  
Les ressources suivantes contiennent des informations supplémentaires qui s’appliquent à cette section.  

-   Document RFC *1305* dans la base de données RFC de l’IETF  

