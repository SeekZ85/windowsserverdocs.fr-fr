---
title: Résolution des problèmes au niveau du proxy d’application web
description: ''
author: kgremban
manager: femila
ms.date: 07/13/2016
ms.topic: article
ms.prod: windows-server-threshold
ms.assetid: a2fef55d-747b-4e20-8f21-5f8807e7ef87
ms.technology: web-app-proxy
ms.openlocfilehash: c63dbc415765cbe60bfbde7bf180f3dd967d6ab8
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59841580"
---
# <a name="troubleshooting-web-application-proxy"></a>Résolution des problèmes au niveau du proxy d’application web

>S'applique à : Windows Server 2016

**Ce contenu est pertinent pour la version locale de Proxy d’Application Web. Pour activer un accès sécurisé aux applications locales sur le cloud, consultez le [contenu Azure Proxy d’Application AD](https://azure.microsoft.com/documentation/articles/active-directory-application-proxy-get-started/).**  
  
Cette section fournit des procédures de dépannage pour le Proxy d’Application Web, y compris des solutions et des explications de l’événement. Il existe trois emplacements où les erreurs sont affichées :  
  
-   Dans la console administrateur de Proxy d’Application Web  
  
    Chaque ID d’événement figurant dans la console administrateur peut être affiché dans l’Observateur d’événements Windows et les descriptions correspondantes et solutions sont trouvent ci-dessous.  
  
    Ouvrez l’Observateur d’événements et recherchez des événements liés au Proxy d’Application Web sous **journaux des Applications et Services** > **Microsoft** > **Windows**  >  **Proxy d’Application web** > **Admin**  
  
    ![](media/Troubleshooting-Web-Application-Proxy/WebApplicationProxyTroubleshooting.png)  
  
    Si nécessaire, des journaux détaillés sont disponibles en activant analytique et de journaux de débogage et activer le journal de session Proxy d’Application Web, trouvé dans l’Observateur d’événements Windows sous \ Microsoft \ Windows \ Proxy d’Application Web \ administrateur.  
  
-   Des erreurs de PowerShell  
  
    Événements pour les problèmes rencontrés lors de la configuration sont affichés dans PowerShell.  
  
    Toutes les erreurs sont présentés à l’utilisateur de PowerShell à l’aide des invites d’erreur PowerShell standards. Toutes les commandes PowerShell sont enregistrés en tant qu’événements. Tous les événements qui se produisent dans PowerShell sont répertoriés dans l’Observateur d’événements Windows avec le numéro d’ID 12016 et sont définis ci-dessous dans la section PowerShell.  
  
-   Dans Best Practices Analyzer  
  
    Ces événements sont décrits dans le [Best Practices Analyzer pour le Proxy d’Application Web](assetId:///995f5cea-e334-4ce6-a14c-6a2d03c0c79a)  
  
## <a name="powershell-messages"></a>Messages de PowerShell  
  
|Événement ou symptôme|Cause possible|Résolution|  
|--------------------|------------------|--------------|  
|Le certificat de confiance (« ADFS ProxyTrust - <WAP machine name>») n’est pas valide|Cela peut se produire pour l'une des raisons suivantes :<br /><br />-L’ordinateur Proxy d’Application a été arrêté pendant trop longtemps.<br />-Les déconnexions entre le Proxy d’Application Web et les services AD FS<br />-Problèmes d’infrastructure certificate<br />-Les modifications sur l’ordinateur AD FS ou le processus de renouvellement entre le Proxy d’Application Web et les services AD FS n’avez pas exécuté comme prévu toutes les 8 heures, puis dont ils ont besoin renouveler l’approbation<br />-L’horloge de l’ordinateur Proxy d’Application Web et les services AD FS ne sont pas synchronisées.|Assurez-vous que les horloges sont synchronisées. Exécutez l’applet de commande Install-WebApplicationProxy.|  
|Données de configuration est introuvable dans AD FS|Cela peut être parce que le Proxy d’Application Web n’a pas été entièrement installé encore ou en raison de modifications dans la base de données AD FS ou d’endommagement de la base de données.|Exécutez l’applet de commande Install-WebApplicationProxy.|  
|Une erreur s’est produite lors de la tentative de Proxy d’Application Web lire la configuration d’AD FS.|Cela peut indiquer que AD FS n’est pas accessible, ou qu’AD FS a rencontré un problème interne tente de lire la configuration à partir de la base de données AD FS.|Vérifiez que AD FS est accessible et fonctionne correctement.|  
|Les données de configuration stockées dans AD FS sont endommagées ou le Proxy d’Application Web n’a pas pu analyser.<br /><br />OU<br /><br />Proxywas d’Application Web Impossible de récupérer la liste des Parties de confiance à partir d’AD FS.|Cela peut se produire si les données de configuration a été modifiées dans AD FS.|Redémarrez le Proxyservice d’Application Web. Si le problème persiste, exécutez l’applet de commande Install-WebApplicationProxy.|  
  
## <a name="administrator-console-events"></a>Événements de la Console Administrateur  
Les événements de console administrateur suivants indiquent généralement des erreurs d’authentification, tokes non valides ou expiré les cookies.  
  
|Événement ou symptôme|Cause possible|Résolution|  
|--------------------|------------------|--------------|  
|11005<br /><br />Proxy d’Application Web n’a pas pu créer la clé de chiffrement de cookie à l’aide de la clé secrète à partir de la configuration.|Le paramètre « AccessCookiesEncryptionKey » de configuration globale a été modifié par la commande PowerShell : Set-WebApplicationProxyConfiguration -RegenerateAccessCookiesEncryptionKey|Aucune action n’est requise. Le cookie problématique a été supprimé et l’utilisateur a été redirigé vers STS pour l’authentification.|  
|12000<br /><br />Proxy d’Application Web ne peut pas vérifier les modifications de configuration pendant au moins 60 minutes|Proxy d’Application Web ne peut pas accéder à la configuration de Proxy d’Application Web à l’aide de la commande Get-WebApplicationProxyConfiguration/Application. Cela est généralement dû à un manque de connectivité avec AD FS ou le besoin de renouveler la relation d’approbation avec AD FS.|Vérifiez la connectivité avec AD FS. Pour cela, à l’aide de la liaison de https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake qu’il existe de relation d’approbation entre les services AD FS et le Proxy d’Application Web. Si ces solutions ne fonctionnent pas, exécutez l’applet de commande Install-WebApplicationProxy.|  
|12003<br /><br />Proxy d’Application Web n’a pas pu analyser le cookie d’accès.|Cela peut indiquer que le Proxy d’Application Web et les services AD FS ne sont pas connectés ou qu’ils ne reçoivent pas la même configuration.|Vérifiez la connectivité avec AD FS. Pour cela, à l’aide de la liaison de https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake qu’il existe de relation d’approbation entre les services AD FS et le Proxy d’Application Web. Si ces solutions ne fonctionnent pas, exécutez l’applet de commande Install-WebApplicationProxy.|  
|12004<br /><br />Proxy d’Application Web a reçu une demande avec un cookie d’accès non valide.|Cet événement peut indiquer que le Proxy d’Application Web et les services AD FS ne sont pas connectés ou qu’ils ne reçoivent pas la même configuration.<br /><br />Si vous avez exécuté le paramètre « AccessCookiesEncryptionKey » a été chaged par Set-WebApplicationProxyConfiguration - RegenerateAccessCookiesEncryptionKey commande PowerShell, cet événement est normal et ne requiert aucune étape de résolution.|Vérifiez la connectivité avec AD FS. Pour cela, à l’aide de la liaison de https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake qu’il existe de relation d’approbation entre les services AD FS et le Proxy d’Application Web. Si ces solutions ne fonctionnent pas, exécutez l’applet de commande Install-WebApplicationProxy.|  
|12008<br /><br />Proxy d’Application Web a dépassé le nombre maximal de tentatives d’authentification Kerberos autorisé vers le serveur principal.|Cet événement peut indiquer une configuration incorrecte entre le Proxy d’Application Web et le serveur d’applications principal ou un problème de configuration de la date et l’heure sur les deux ordinateurs.|Le serveur principal a refusé le ticket Kerberos créé par le Proxy d’Application Web. Vérifiez que la configuration du Proxy d’Application Web et le serveur d’applications principal sont configurés correctement.<br /><br />Assurez-vous que la configuration de la date et l’heure sur le Proxy d’Application Web et le serveur d’applications principal sont synchronisées.|  
|12011<br /><br />Proxy d’Application Web a reçu une demande avec une signature de cookie d’accès non valide.|Cet événement peut indiquer que le Proxy d’Application Web et les services AD FS ne sont pas connectés ou qu’ils ne reçoivent pas la même configuration. Si vous avez exécuté le paramètre « AccessCookiesEncryptionKey » a été chaged par Set-WebApplicationProxyConfiguration - RegenerateAccessCookiesEncryptionKey commande PowerShell, cet événement est normal et ne requiert aucune étape de résolution.|Vérifiez la connectivité avec AD FS. Pour cela, à l’aide de la liaison de https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake qu’il existe de relation d’approbation entre les services AD FS et le Proxy d’Application Web. Si ces solutions ne fonctionnent pas, exécutez l’applet de commande Install-WebApplicationProxy.|  
|12027<br /><br />Le proxy a rencontré une erreur inattendue lors du traitement de la demande. Le nom fourni n’est pas un nom de compte formé correctement.|Cet événement peut indiquer une configuration incorrecte entre le Proxy d’Application Web et le serveur de contrôleur de domaine ou un problème de configuration de date et heure des deux ordinateurs.|Le contrôleur de domaine a refusé le ticket Kerberos créé par le Proxy d’Application Web. Vérifiez que la configuration du Proxy d’Application Web et le serveur d’applications principal sont correctement configurés, en particulier la configuration du SPN. Assurez-vous que le Proxy d’Application Web est joint à un domaine pour le même domaine que le contrôleur de domaine pour vous assurer que le contrôleur de domaine a établit une relation d’approbation avec Web Application Proxy.Make bien sûr que la configuration de la date et l’heure sur le Proxy d’Application Web et le contrôleur de domaine sont synchronisées.|  
|13012<br /><br />Proxy d’Application Web reçu une signature du jeton edge non valide||Assurez-vous que vous mis à jour le Proxy d’Application Web avec [Ko 2955164](https://go.microsoft.com/fwlink/?LinkId=400701).|  
|13013<br /><br />Proxy d’Application Web a reçu une demande qui contenue un jeton edge a expiré.|Proxy d’Application Web et les services AD FS n’ont pas de horloges synchronisées.|Synchroniser les horloges entre le Proxy d’Application Web et AD FS.|  
|13014<br /><br />Proxy d’Application Web a reçu une demande avec un jeton edge non valide. Le jeton n’est pas valid, car il ne peut pas être analysée.|Cela peut indiquer un problème avec la configuration AD FS.|Vérifiez votre configuration AD FS et, si nécessaire, restaurez la configuration par défaut.|  
|13015<br /><br />Proxy d’Application Web a reçu une demande avec un cookie d’accès a expiré.|Cela peut indiquer des horloges ne sont pas synchronisées.|Si vous travaillez avec un cluster de machines de Proxy d’Application Web, assurez-vous que la date et heure des machines est synchronisée.|  
|13016<br /><br />Proxy d’Application Web ne peut pas récupérer un ticket Kerberos pour l’utilisateur, car il n’existe pas de nom UPN dans le jeton edge ou dans le cookie d’accès.|Il existe un problème avec la configuration de STS.|Corrigez la configuration de la revendication UPN dans STS.|  
|13019<br /><br />Proxy d’Application Web ne peut pas récupérer un ticket Kerberos pour l’utilisateur en raison de l’erreur API générale suivante|Cet événement peut indiquer une configuration incorrecte entre le Proxy d’Application Web et le serveur de contrôleur de domaine ou un problème de configuration de date et heure des deux ordinateurs.|Le contrôleur de domaine a refusé le ticket Kerberos créé par le Proxy d’Application Web. Vérifiez que la configuration du Proxy d’Application Web et le serveur d’applications principal sont correctement configurés, en particulier la configuration du SPN. Assurez-vous que le Proxy d’Application Web est joint à un domaine pour le même domaine que le contrôleur de domaine pour vous assurer que le contrôleur de domaine a établit une relation d’approbation avec Web Application Proxy.Make bien sûr que la configuration de la date et l’heure sur le Proxy d’Application Web et le contrôleur de domaine sont synchronisées.|  
|13020<br /><br />Proxy d’Application Web ne peut pas récupérer un ticket Kerberos pour l’utilisateur, car le SPN du serveur principal n’est pas défini.|Cet événement peut indiquer une configuration incorrecte entre le Proxy d’Application Web et le serveur de contrôleur de domaine ou un problème de configuration de date et heure des deux ordinateurs.|Le contrôleur de domaine a refusé le ticket Kerberos créé par le Proxy d’Application Web. Vérifiez que la configuration du Proxy d’Application Web et le serveur d’applications principal sont correctement configurés, en particulier la configuration du SPN. Assurez-vous que le Proxy d’Application Web est joint à un domaine pour le même domaine que le contrôleur de domaine pour vous assurer que le contrôleur de domaine a établit une relation d’approbation avec Web Application Proxy.Make bien sûr que la configuration de la date et l’heure sur le Proxy d’Application Web et le contrôleur de domaine sont synchronisées.|  
|13022<br /><br />Proxy d’Application Web ne peut pas authentifier l’utilisateur, car le serveur principal répond aux tentatives d’authentification Kerberos avec une erreur HTTP 401.|Cet événement peut indiquer une configuration incorrecte entre le Proxy d’Application Web et le serveur d’applications principal ou un problème de configuration de la date et l’heure sur les deux ordinateurs.|Le serveur principal a refusé le ticket Kerberos créé par le Proxy d’Application Web. Vérifiez que la configuration du Proxy d’Application Web et le serveur d’applications principal sont configurés correctement. Assurez-vous que la configuration de la date et l’heure sur le Proxy d’Application Web et le serveur d’applications principal sont synchronisées.|  
|13025<br /><br />Le client ne présentait pas un certificat SSL pour le Proxy d’Application Web.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées. Assurez-vous que l’empreinte est configurée pour le Proxy d’Application Web est celui qui convient.|  
|13026<br /><br />Le client a présenté un certificat SSL pour le Proxy d’Application Web, mais le certificat n’est pas valide : le certificat ne correspond pas à l’empreinte numérique.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées. Assurez-vous que l’empreinte est configurée pour le Proxy d’Application Web est celui qui convient.|  
|13028<br /><br />Proxy d’Application Web a reçu une demande qui contenue un jeton edge n’est pas valide.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées.|  
|13030<br /><br />Le client a présenté un certificat SSL pour le Proxy d’Application Web, mais le fournisseur d’approbation n’approuve pas l’autorité de certification qui a émis le certificat client.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées. Assurez-vous que l’empreinte est configurée pour le Proxy d’Application Web est celui qui convient.|  
|13031<br /><br />Le client a présenté un certificat SSL pour le Proxy d’Application Web, mais la chaîne de certificats s’est terminée par un certificat racine qui n’est pas approuvé par le fournisseur d’approbation.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées. Assurez-vous que l’empreinte est configurée pour le Proxy d’Application Web est celui qui convient.|  
|13032<br /><br />Le client a présenté un certificat SSL pour le Proxy d’Application Web, mais le certificat n’était pas valide pour l’utilisation demandée.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées. Assurez-vous que l’empreinte est configurée pour le Proxy d’Application Web est celui qui convient.|  
|13033<br /><br />Le client a présenté un certificat SSL pour le Proxy d’Application Web, mais le certificat n’était pas dans sa période de validité lors de la vérification par rapport à l’horloge système actuelle ou l’horodatage du fichier signé.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées. Assurez-vous que l’empreinte est configurée pour le Proxy d’Application Web est celui qui convient.|  
|13034<br /><br />Le client a présenté un certificat SSL pour le Proxy d’Application Web, mais le certificat n’était pas valide.|Cet événement peut indiquer un problème de configuration de la date et l’heure.|Assurez-vous que l’infrastructure de certificat est valide et que la date et heure de Proxy d’Application Web et les services AD FS sont synchronisées. Assurez-vous que l’empreinte est configurée pour le Proxy d’Application Web est celui qui convient.|  
  
Les événements de console administrateur suivants sont généralement un bon indicateur des problèmes devant être associées à la configuration, telles que l’approvisionnement, demande qui ne sont pas réussie, les serveurs principaux qui ne sont pas accessibles et dépassement de mémoire tampon.  
  
|Événement ou symptôme|Cause possible|Résolution|  
|--------------------|------------------|--------------|  
|12019<br /><br />Proxy d’Application Web n’a pas pu créer un écouteur pour l’URL suivante.|Une cause possible de l’événement est qu’un autre service est à l’écoute à la même URL.|L’administrateur devez vous assurer que personne n’écoute ou lie aux mêmes URL. Pour ce faire, exécutez la commande : netsh http show urlacl. Si cette URL est utilisée par un autre composant en cours d’exécution sur l’ordinateur Proxy d’Application Web, supprimez-le ou utilisez une autre URL pour publier des applications via le Proxy d’Application Web.|  
|12020<br /><br />Proxy d’Application Web n’a pas pu créer une réservation pour l’URL suivante.|Une cause possible de l’événement est un autre service qu’une réservation sur la même URL.|L’administrateur doit vérifier que personne n’est liée aux mêmes URL. Pour ce faire, exécutez la commande : netsh http show urlacl. Si cette URL est utilisée par un autre composant en cours d’exécution sur l’ordinateur Proxy d’Application Web, supprimez-le ou utilisez une autre URL pour publier des applications via le Proxy d’Application Web.|  
|12021<br /><br />Proxy d’Application Web n’a pas pu lier le certificat de serveur SSL. Tous les autres paramètres de configuration ont été appliquées.|Impossible de créer et définir un enregistrement de la configuration des données de certificat SSL.|Assurez-vous que les empreintes numériques de certificats sont configurés pour Proxyapplications d’Application Web sont installés sur tous les ordinateurs de Proxy d’Application Web avec une clé privée dans le magasin de l’ordinateur local.|  
|13001<br /><br />Le certificat de serveur SSL présenté au Proxy d’Application Web par le serveur principal n’est pas valide ; le certificat n’est pas approuvé.|Une ou plusieurs erreurs ont été trouvées dans le certificat Secure Sockets Layer (SSL) envoyé par le serveur. Cela peut indiquer que le serveur principal fourni un certificat SSL qui n’était pas valid ou qu’il n’existe aucune relation d’approbation entre le Proxy d’Application Web et le serveur principal.|Valider un certificat SSL du serveur principal. Assurez-vous que l’ordinateur Proxy d’Application Web est configuré avec la racine de droite autorités de certification pour approuver le certificat de serveur principal.|  
|13006|Lorsque le code d’erreur est 0x80072ee7, le failurrre est dû à l’incapacité à résoudre l’URL du serveur principal. Autres codes d’erreur sont décrites dans [https://msdn.microsoft.com/library/windows/desktop/aa384110(v=vs.85)](https://msdn.microsoft.com/library/windows/desktop/aa384110(v=vs.85))|Vérifiez que l’URL du serveur principal est correct et que son nom peut être résolu correctement à partir de l’ordinateur Proxy d’Application Web.|  
|13007<br /><br />La réponse HTTP du serveur principal n’a pas reçue dans l’intervalle attendu.|La demande du serveur principal a expiré ou est lent ou ne répond pas.|Vérifiez la configuration du serveur principal. Si elle est très lente, vérifiez la connectivité vers le serveur principal et également envisager de modifier l’applet de commande du paramètre global configuration Proxy d’Application Web pour InactiveTransactionsTimeoutSec.|  
  
## <a name="see-also"></a>Voir aussi  
[Nouveautés du Proxy d’Application Web dans Windows Server 2016](web-application-proxy-windows-server.md)  
[Utilisation de Proxy d’Application Web](assetId:///b607b717-2172-4271-98d1-fa8162e0bb2e)  
  


